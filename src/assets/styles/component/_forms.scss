// forms

@mixin form-input($rounded) {
  position: relative;
  box-sizing: border-box;
  background-color: $form-bg-color;
  border: $form-border-width solid $form-border-color;
  border-radius: $rounded;
  // height: $height;
  transition: 0.2s;
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin: 0;
  padding: 0;
  font-size: $text-md;
}

@mixin form-elements($padding) {
  input:not([type='checkbox']):not([type='radio']),
  select,
  textarea {
    appearance: none;
    outline: none;
    border: none;
    border-radius: inherit;
    background-color: transparent;
    vertical-align: middle;
    text-align: inherit;
    font-size: inherit;
    color: inherit;
    width: 100%;
    padding: $padding;
    margin: 0;
    user-select: inherit;
    white-space: pre-wrap;
    word-break: break-all;
    word-wrap: break-word;
  }

  // 필요한지 한번 더 쳌
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus,
  input:-webkit-autofill:active {
    transition: background-color 5000s ease-in-out 0s;
    box-shadow: 0 0 0px 1000px transparent inset;
    -webkit-transition: background-color 9999s ease-out;
    -webkit-text-fill-color: inherit;
  }
  input::-ms-clear,
  input::-ms-reveal {
    display: none;
    width: 0;
    height: 0;
  }
  input::-webkit-search-decoration,
  input::-webkit-search-cancel-button,
  input::-webkit-search-results-button,
  input::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  select {
    // background-image: url('@/assets/images/l-ico-20-dropdown-arrow.svg?url');
    background-position: right 0.75rem center;
    background-repeat: no-repeat;
    background-size: 20px;
    padding-right: 1.5rem;
  }

  input[type='search'] {
    &::-webkit-search-cancel-button {
      // background: url('@/assets/images/l-ico-20-del.svg?url') no-repeat;
      background-size: 100% 100%;
      background-position: center center;
      width: 16px;
      height: 16px;
      cursor: pointer;
    }
  }
}

@mixin form-pseudo {
  transition: 0.3s;

  input,
  select,
  textarea {
    &:focus,
    &:focus-within {
      outline: none;
      border-color: $form-border-active-color;
      color: var(--gray-8);
    }
    &:active {
      border-color: $form-border-active-color;
    }

    &:invalid {
      border-color: var(--error) !important;
    }
  }

  &.error {
    border-color: var(--error) !important;
  }

  &.disabled {
    background-color: $form-bg-disabled-color !important;
    border-color: $form-border-disabled-color !important;
    color: var(--gray-6) !important;
    input {
      cursor: not-allowed;
    }
  }
}

// label
@mixin label {
  font-size: $text-sm;
}

/* ================================= form-input ================================= */

.form-input {
  @include form-input($rounded-lg);
  @include form-elements($form-padding);
  @include form-pseudo;

  font-size: $text-md;

  &.small {
    @include form-input($rounded-xs);
    @include form-elements($form-padding-sm);

    .prefix,
    .suffix {
      padding: 0 6px;
    }
    .suffix {
      padding-left: 8px;
    }

    select {
      background-position: right 0.5rem center;
      padding-right: 2rem;
    }
  }

  .prefix,
  .suffix {
    flex-shrink: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    margin: 0;
    padding: 0 12px;
  }

  // 예외사항
  &.gray {
    background-color: var(--gray-1);
    border-color: transparent;
  }
  &.none {
    border-width: 0;
    background-color: transparent;
    input {
      background-color: transparent !important;
    }
  }

  &[readonly='readonly'] {
    border: 0;
    background-color: transparent !important;
    color: var(--gray-9);
  }
}

// field container
.fieldset {
  width: 100%;

  label {
    @include label;
  }
}

.invalid-feedback {
  transition: all 0.3s ease-out;
  margin: 4px 12px 4px 12px;
  font-size: $text-xs;
  list-style: normal;
  color: var(--error);
  animation: fadeUp 0.2s ease-in-out forwards;
  display: inline-flex;
  column-gap: 0.25rem;

  > svg {
    flex-shrink: 0;
  }

  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateX(-1rem);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
}

@function svgIcon($color) {
  $color: '%23' + $color;
  $icon: "data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg xmlns='http://www.w3.org/2000/svg' width='10px' height='8px' viewBox='0 0 10 8' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg stroke='none' stroke-width='1' fill='none'%3E%3Cg id='l' transform='translate(-6.000000, -8.000000)' fill='#{$color}' fill-rule='nonzero'%3E%3Cpath d='M15.5351068,8.53510678 C15.9256311,8.92563107 15.9256311,9.55879605 15.5351068,9.94932034 L10.5943125,14.890866 C10.5914787,14.8937683 10.5886237,14.8966577 10.5857475,14.8995339 C10.4655861,15.0196952 10.3224529,15.1028838 10.1704844,15.1490997 L10.054684,15.1763632 L10.054684,15.1763632 L9.93767207,15.190694 L9.93767207,15.190694 L9.81922115,15.1902279 C9.74058626,15.1856063 9.66239314,15.1717416 9.58640886,15.1486336 L9.4746981,15.1075054 C9.45036777,15.0967721 9.42637783,15.0850213 9.40279281,15.0722531 C9.31976925,15.0271313 9.24151801,14.9694401 9.17114575,14.8990678 L6.34310678,12.0711068 C5.95258249,11.6805825 5.95258249,11.0474175 6.34310678,10.6568932 C6.73363107,10.2663689 7.36679605,10.2663689 7.75732034,10.6568932 L9.87721356,12.7772136 L14.1208932,8.53510678 C14.5114175,8.14458249 15.1445825,8.14458249 15.5351068,8.53510678 Z' %3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/svg%3E";
  @return url($icon);
}

/* =========================== Checkbox =========================== */

@mixin form-check {
  display: inline-block;
  height: 22px;

  input + label {
    display: inline-flex;
    align-items: center;
    cursor: pointer;
  }

  input {
    display: none;
  }

  input {
    &[type='checkbox'] + label:before {
      content: '';
      flex-shrink: 0;
      box-sizing: border-box;
      position: relative;
      display: inline-block;
      width: 22px;
      height: 22px;
      border-width: 2px;
      border-style: solid;
      border-color: #e4e4e4;
      background-color: $form-bg-color;
      border-radius: $rounded;
      transition: 0.2s;
      margin-right: 0.5rem;
    }

    + label:active:before {
      transform-origin: center;
      transform: scale(0.5);
    }

    &:checked + label:before {
      background: $light svgIcon(fff) no-repeat center center;
      border-color: $light;
    }

    &:disabled + label:before {
      transform: scale(1);
      background: var(--gray-2);
      border-color: var(--gray-2);
    }

    &:disabled + label,
    &:checked:disabled + label {
      color: var(--gray-4);
    }

    &:not(:checked):disabled + label,
    &:checked:disabled + label {
      cursor: not-allowed;
    }

    // radio
    &[type='radio'] + label:before {
      content: '';
      box-sizing: border-box;
      position: relative;
      display: inline-block;
      width: 22px;
      height: 22px;
      border: 0;
      background: transparent
        url("data:image/svg+xml,%3Csvg width='22' height='22' viewBox='0 0 22 22' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='11' cy='11' r='10' fill='none' stroke='%23e4e4e4' stroke-width='2'/%3E%3Ccircle r='4' transform='matrix(1 0 0 -1 11 11)' fill='%23e4e4e4'/%3E%3C/svg%3E%0A")
        no-repeat center center;
      border-radius: $rounded-full;
      transition: 0.2s;
      margin-right: 0.5rem;
    }

    &[type='radio']:checked + label:before {
      background: transparent
        url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg viewBox='0 0 22 22' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3El-radio-base%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='%23ee7e6d' fill-rule='evenodd'%3E%3Cg id='l-radio-base' transform='translate(1.000000, 1.000000)' fill-rule='nonzero'%3E%3Ccircle id='Oval' cx='10' cy='10' r='10'%3E%3C/circle%3E%3Ccircle id='Oval' fill='%23fff' transform='translate(10.000000, 10.000000) scale(-1, 1) rotate(-180.000000) translate(-10.000000, -10.000000) ' cx='10' cy='10' r='4'%3E%3C/circle%3E%3C/g%3E%3C/g%3E%3C/svg%3E")
        no-repeat center center;
      border: 0;
    }

    &[type='radio']:disabled + label:before {
      background: transparent
        url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg viewBox='0 0 22 22' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Ctitle%3El-radio-base%3C/title%3E%3Cg stroke='none' stroke-width='1' fill='%23e4e4e4' fill-rule='evenodd'%3E%3Cg id='l-radio-base' transform='translate(1.000000, 1.000000)' fill-rule='nonzero'%3E%3Ccircle id='Oval' cx='10' cy='10' r='10'%3E%3C/circle%3E%3Ccircle id='Oval' fill='%23fff' transform='translate(10.000000, 10.000000) scale(-1, 1) rotate(-180.000000) translate(-10.000000, -10.000000) ' cx='10' cy='10' r='4'%3E%3C/circle%3E%3C/g%3E%3C/g%3E%3C/svg%3E")
        no-repeat center center;
      border: 0;
    }
  }
}

.form-check {
  @include form-check();
  color: var(--gray-6);
}

/* =========================== ToggleSwitch =========================== */

.toggle-control {
  display: block;
  position: relative;
  cursor: pointer;

  > label {
    display: block;
    width: $switch-width;
    height: $switch-height;
  }

  input {
    position: absolute;
    opacity: 0;
    height: 0;
    width: 0;
    cursor: pointer;
  }

  input:checked ~ .control {
    background-color: $switch-bg-color-on;
    cursor: pointer;

    &::after {
      left: $switch-width - $switch-control-size - $switch-gutter;
      box-shadow: $switch-shadow-on;
    }
  }

  .control {
    position: absolute;
    top: 0;
    left: 0;
    height: $switch-height;
    width: $switch-width;
    border-radius: $switch-radius;
    background-color: $switch-bg-color-off;
    transition: background-color $switch-control-speed $switch-control-ease;
    cursor: pointer;

    &::after {
      content: '';
      position: absolute;
      left: $switch-gutter;
      top: $switch-gutter;
      width: $switch-control-size;
      height: $switch-control-size;
      border-radius: $switch-radius;
      background: $switch-control-color;
      box-shadow: $switch-shadow-off;
      transition: left $switch-control-speed $switch-control-ease;
    }
  }
}

.form-input.textarea {
  height: auto;
  textarea {
    font-family: inherit;
    resize: none;
    overflow: hidden;
  }
}